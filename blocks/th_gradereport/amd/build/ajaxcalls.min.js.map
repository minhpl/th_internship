{"version":3,"sources":["../src/ajaxcalls.js"],"names":["define","$","notification","ajax","Ajaxcall","value","prototype","loadcourses","makhoa","malop","userid","time_from","time_to","onDocumentReady","promises","call","methodname","args","fail","exception","attr","then","data","select_course","datavalue","each","i","obj","push","id","optadded","optel","optvalue","parseInt","includes","remove","append","text","coursefullname","removeAttr"],"mappings":"AAAAA,OAAM,kCAAC,CAAC,QAAD,CAAW,mBAAX,CAAgC,WAAhC,CAAD,CACF,SAASC,CAAT,CAAYC,CAAZ,CAA0BC,CAA1B,CAAgC,CAE5B,QAASC,CAAAA,CAAT,EAAoB,CAChB,KAAKC,KAAL,CAAa,SAChB,CAEDD,CAAQ,CAACE,SAAT,CAAmBC,WAAnB,CAAiC,SAASC,CAAT,CAAiBC,CAAjB,CAAwBC,CAAxB,CAAgCC,CAAhC,CAA2CC,CAA3C,CAA6E,IAAzBC,CAAAA,CAAyB,2DAC1G,GAAI,CAACL,CAAD,EAAqB,EAAV,EAAAA,CAAf,CAA6BA,CAAM,CAAG,IAAT,CAC7B,GAAI,CAACC,CAAD,EAAmB,EAAT,EAAAA,CAAd,CAA2BA,CAAK,CAAG,IAAR,CAC3B,GAAI,CAACC,CAAD,EAAqB,EAAV,EAAAA,CAAf,CAA6BA,CAAM,CAAG,CAAT,CAE7B,GAAII,CAAAA,CAAQ,CAAGX,CAAI,CAACY,IAAL,CAAU,CAAC,CACtBC,UAAU,CAAE,yBADU,CAEtBC,IAAI,CAAE,CACFT,MAAM,CAAEA,CADN,CAEFC,KAAK,CAAEA,CAFL,CAGFC,MAAM,CAAEA,CAHN,CAIFC,SAAS,CAAEA,CAJT,CAKFC,OAAO,CAAEA,CALP,CAFgB,CAUtBM,IAAI,CAAEhB,CAAY,CAACiB,SAVG,CAAD,CAAV,CAAf,CAaAlB,CAAC,CAAC,6BAAD,CAAD,CAAiCmB,IAAjC,CAAsC,UAAtC,CAAkD,MAAlD,EACAN,CAAQ,CAAC,CAAD,CAAR,CAAYO,IAAZ,CAAiB,SAASC,CAAT,CAAe,IACxBC,CAAAA,CAAa,CAAGtB,CAAC,CAAC,uBAAD,CADO,CAGxBuB,CAAS,CAAG,EAHY,CAI5BvB,CAAC,CAACwB,IAAF,CAAOH,CAAP,CAAa,SAASI,CAAT,CAAYC,CAAZ,CAAiB,CAC1BH,CAAS,CAACI,IAAV,CAAeD,CAAG,CAACE,EAAnB,CACH,CAFD,EAIA,GAAIC,CAAAA,CAAQ,CAAG,EAAf,CACA7B,CAAC,CAAC,8BAAD,CAAD,CAAkCwB,IAAlC,CAAuC,SAASC,CAAT,CAAYK,CAAZ,CAAmB,CACtD,GAAS,CAAL,EAAAL,CAAJ,CAAY,OACZ,GAAIb,CAAJ,CAAqB,CACjB,GAAImB,CAAAA,CAAQ,CAAGC,QAAQ,CAAChC,CAAC,CAAC8B,CAAD,CAAD,CAASX,IAAT,CAAc,OAAd,CAAD,CAAvB,CACA,GAAI,CAACI,CAAS,CAACU,QAAV,CAAmBF,CAAnB,CAAL,CAAmC,CAC/BD,CAAK,CAACI,MAAN,EACH,CAFD,IAEO,CACHL,CAAQ,CAACF,IAAT,CAAcI,CAAd,CACH,CACJ,CAPD,IAOO,CACHD,CAAK,CAACI,MAAN,EACH,CACJ,CAZD,EAcAlC,CAAC,CAACwB,IAAF,CAAOH,CAAP,CAAa,SAASI,CAAT,CAAYC,CAAZ,CAAiB,CAC1B,GAAIE,CAAAA,CAAE,CAAGF,CAAG,CAACE,EAAb,CACA,GAAI,CAACC,CAAQ,CAACI,QAAT,CAAkBL,CAAlB,CAAL,CAA4B,CACxBN,CAAa,CAACa,MAAd,CAAqBnC,CAAC,CAAC,UAAD,CAAa,CAC/BI,KAAK,CAAEsB,CAAG,CAACE,EADoB,CAE/BQ,IAAI,CAAEV,CAAG,CAACW,cAFqB,CAAb,CAAtB,CAIH,CACJ,CARD,EAUArC,CAAC,CAAC,6BAAD,CAAD,CAAiCsC,UAAjC,CAA4C,UAA5C,CAAwD,MAAxD,CACH,CAlCD,CAmCH,CAtDD,CAwDA,MAAOnC,CAAAA,CACV,CAhEC,CAAN","sourcesContent":["define(['jquery', 'core/notification', 'core/ajax'],\n    function($, notification, ajax) {\n\n        function Ajaxcall() {\n            this.value = \"ajax ok\";\n        };\n\n        Ajaxcall.prototype.loadcourses = function(makhoa, malop, userid, time_from, time_to, onDocumentReady = false) {\n            if (!makhoa || makhoa == '') makhoa = null;\n            if (!malop || malop == '') malop = null;\n            if (!userid || userid == '') userid = 0;\n\n            var promises = ajax.call([{\n                methodname: 'local_thlib_loadcourses',\n                args: {\n                    makhoa: makhoa,\n                    malop: malop,\n                    userid: userid,\n                    time_from: time_from,\n                    time_to: time_to\n                },\n\n                fail: notification.exception\n            }]);\n\n            $(\"#fitem_id_courseidarr input\").attr(\"readonly\", \"true\");\n            promises[0].then(function(data) {\n                var select_course = $(\"select#id_courseidarr\");\n\n                var datavalue = [];\n                $.each(data, function(i, obj) {\n                    datavalue.push(obj.id);\n                });\n\n                var optadded = [];\n                $(\"select#id_courseidarr option\").each(function(i, optel) {\n                    if (i == 0) return;\n                    if (onDocumentReady) {\n                        var optvalue = parseInt($(optel).attr('value'));\n                        if (!datavalue.includes(optvalue)) {\n                            optel.remove();\n                        } else {\n                            optadded.push(optvalue);\n                        }\n                    } else {\n                        optel.remove();\n                    }\n                });\n\n                $.each(data, function(i, obj) {\n                    var id = obj.id;\n                    if (!optadded.includes(id)) {\n                        select_course.append($('<option>', {\n                            value: obj.id,\n                            text: obj.coursefullname\n                        }));\n                    }\n                });\n\n                $(\"#fitem_id_courseidarr input\").removeAttr(\"readonly\", \"true\");\n            });\n        };\n\n        return Ajaxcall;\n    });"],"file":"ajaxcalls.min.js"}