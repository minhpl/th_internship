{"version":3,"sources":["../src/ajaxcalls.js"],"names":["define","$","notification","ajax","Ajaxcall","value","prototype","loadcourses","makhoaarr","maloparr","useridarr","time_from","time_to","onDocumentReady","promises","call","methodname","args","fail","exception","attr","then","data","select_course","datavalue","each","i","obj","push","id","optadded","optel","optvalue","parseInt","includes","remove","append","text","coursefullname","removeAttr"],"mappings":"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","sourcesContent":["define(['jquery', 'core/notification', 'core/ajax'],\n    function($, notification, ajax) {\n\n        function Ajaxcall() {\n            this.value = \"ajax ok\";\n        };\n\n        Ajaxcall.prototype.loadcourses = function(makhoaarr, maloparr, useridarr, time_from, time_to, onDocumentReady = false) {\n            if (!makhoaarr || makhoaarr == '') makhoaarr = [];\n            if (!maloparr || maloparr == '') maloparr = [];\n            if (!useridarr || useridarr == '') useridarr = [];\n\n            //console.log(makhoaarr);\n            //console.log(maloparr);\n            //console.log(useridarr);\n\n            var promises = ajax.call([{\n                methodname: 'local_thlib_loadcourses',\n                args: {\n                    makhoaarr: makhoaarr,\n                    maloparr: maloparr,\n                    useridarr: useridarr,\n                    time_from: time_from,\n                    time_to: time_to\n                },\n\n                fail: notification.exception\n            }]);\n\n            args =  {\n                makhoaarr: makhoaarr,\n                maloparr: maloparr,\n                useridarr: useridarr,\n                time_from: time_from,\n                time_to: time_to\n            };\n\n            //console.log(args);\n\n            $(\"#fitem_id_courseidarr input\").attr(\"readonly\", \"true\");\n            return promises[0].then(function(data) {\n                //console.log(data);\n\n                var select_course = $(\"select#id_courseidarr\");\n\n                var datavalue = [];\n                $.each(data, function(i, obj) {\n                    datavalue.push(obj.id);\n                });\n\n                var optadded = [];\n                $(\"select#id_courseidarr option\").each(function(i, optel) {\n                    if (i == 0) return;\n                    if (onDocumentReady) {\n                        var optvalue = parseInt($(optel).attr('value'));\n                        if (!datavalue.includes(optvalue)) {\n                            optel.remove();\n                        } else {\n                            optadded.push(optvalue);\n                        }\n                    } else {\n                        optel.remove();\n                    }\n                });\n\n                $.each(data, function(i, obj) {\n                    var id = obj.id;\n                    if (!optadded.includes(id)) {\n                        select_course.append($('<option>', {\n                            value: obj.id,\n                            text: obj.coursefullname\n                        }));\n                    }\n                });\n\n                $(\"#fitem_id_courseidarr input\").removeAttr(\"readonly\", \"true\");\n            });\n        };\n\n        return Ajaxcall;\n    });"],"file":"ajaxcalls.min.js"}